<!doctype html>
<html lang="fr">

<head>
    <title>Project</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/javascript.util/0.12.12/javascript.util.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    {% load crispy_forms_tags %}
    {% load bootstrap4 %}
    {% load static %}
    {% load mathfilters %}
</head>

<!-- header row -->
<header>
    <div class="row bg-light ml-3 mr-3 header">
        <div class="col col-md-auto">
            <img src="{% static 'images/logo.png' %}" height="100" class="d-inline-block align-middle mr-2">
            <span class="text-uppercase font-weight-bold">MaKe Our Planet Great Again</span>
        </div>
        <div class="col"></div>
        <div class="col col-md-auto">
            {% if request.user.is_authenticated %}
            <p>Welcome {{ request.user.username }}</p>
            <div >
                <p class="fa fa-plus-square-o"><a href="{% url 'nouveauProject' %}"> Create a new project</a></p></br>
                <p class="fa fa-sign-out"><a href="{% url 'deconnexion' %}"> Sign out</a></p>
            </div>
            {% else %}
            <p class="text-right"><a href="{% url 'accueil' %}">Sign in !</a></p>
            <p class="text-right">No account yet ? <a href="{% url 'inscription' %}">Join Us !</a></p>
            {% endif %}
        </div>
    </div>
</header>
<!-- //header row -->


<body>
    <div class="container">
        <h1>{{ project.nom }}</h1>
        <p> description : {{ project.description }}</p>
        <p> budget actuel : {{ project.budgetActuel }}</p>
        <p> budget cible  : {{ project.budgetCible }}</p>
        <p> posté le : {{ project.datePublication }}</p>
        <p> créateur : <a href="{% url 'userId' id=project.idCreateur.id %}">{{ project.idCreateur }}</a></p>
        <p>difficulte du projet : {{ project.difficulte }}</p>

        <h3> Notes données au projet  </h3>
        <p>moyenne budget : {{ avg_noteBudget }}/10</p>
        <p>moyenne faisabilité : {{ avg_noteFaisabilite }}/10</p>
        <p>moyenne utilité : {{ avg_noteUtilite }}/10 </p>
        {% if moyenne is not None  %}
        <p>moyenne globale : {{ moyenne }}/10 </p>
        {% endif %}


        <h3> Liste des contributeurs </h3>
        {% for values in contributions %}
        <p> {{ values.nom }} - donation : {{ values.contribution }} </p>
        {% empty %}
        <p>Aucun contributeur.</p>
        {% endfor %}


        <!-- Si l'utilisateur est connecté -->
        {% if user.is_authenticated %}
        <h3>Donner</h3>
        <p><a href="{% url 'donate' id=project.id contribution=10  %}">10</a></p>
        <p><a href="{% url 'donate' id=project.id contribution=25 %}">25</a></p>
        <p><a href="{% url 'donate' id=project.id contribution=50 %}">50</a></p>

        <!-- Si l'utilisateur est un expert -->
        {% if user.isExpert  %}
        <!-- Si l'expert a suffisament de karma pour evaluer ce projet -->
        {% if user.karma >= project.difficulte|mul:100 %}
        <!-- Si cet expert n'as pas encore évalué le projet -->
        {% if not hasEvaluated %}
        <h1> Attribuer une nouvelle note  </h1>
        <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}
            {{ form }}
            <button type="submit" class="form-button btn btn-success">Submit</button>
        </form>
        {% else %}
        <p>le projet a deja ete evalue</p>
        {% endif %}
        {% else %}
        <p> pas assez de karma pour evaluer le projet</p>
        {% endif %}
        {% endif %}

        {% endif %}
    </div>
</body>



<!-- footer row -->
<footer>
    <div class="container pt-5 border-bottom">
        <div class="row">
            <div class="col-md-3 col-sm-6 col-6 p-0 float-left mb-3 text-center">
                <h5 class="mb-4 font-weight-bold text-uppercase">Links</h5>
                <ul class="list-group">
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="{% url 'accueil' %}">Home</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="#">Link</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="#">Link</a></li>
                </ul>
            </div>
            <div class="col-md-3 col-sm-6 col-6 p-0 mb-3 float-left text-center">
                <h5 class="mb-4 font-weight-bold text-uppercase">Links</h5>
                <ul class="list-group">
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="#">Link</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="#">Link</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="#">Link</a></li>
                </ul>
            </div>
            <div class="col-md-3 col-sm-6 col-6 mb-3 p-0 float-left text-center">
                <h5 class="mb-4 font-weight-bold text-uppercase">Company</h5>
                <ul class="list-group">
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="{% url 'accueil' %}"></i>About us</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="{% url 'contact' %}"></i>Contact us </a></li>
                </ul>
            </div>
            <div class="col-md-3 col-sm-6 col-6 mb-3 p-0 float-left text-center">
                <h5 class="mb-4 font-weight-bold text-uppercase">Connect</h5>
                <ul class="list-group">
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="https://github.com/KylianViaux/SiteDjangoGreen" target="_blank"><i class="fa fa-github mr-1"></i> Github</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="{% url 'accueil' %}"><i class="fa fa-twitter mr-1"></i> Twitter</a></li>
                    <li class="list-group-item bg-transparent border-0 p-0 mb-2"><a href="{% url 'accueil' %}"><i class="fa fa-facebook mr-1"></i> Facebook</a></li>
                </ul>
            </div>
        </div>
        <div class="col-md-12">
            <div class="py-4 d-flex justify-content-center align-items-center">
                <a class="mr-4" href="{% url 'mentionsLegales' %}">Privacy & terms</a>
            </div>
        </div>
    </div>
    </div>
</footer>
<!-- //footer row -->

</html>
